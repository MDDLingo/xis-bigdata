<!DOCTYPE html>
<html>
  <head>    
    <title>Generated Pie Chart</title>
	<!-- <script src="amcharts/amcharts.js" type="text/javascript"></script>
	<script src="amcharts/serial.js" type="text/javascript"></script> -->
    <script src="http://www.amcharts.com/lib/3/amcharts.js"></script>
	<script src="http://www.amcharts.com/lib/3/pie.js"></script>
	<script src="http://www.amcharts.com/lib/3/themes/light.js"></script>
	<script src="https://code.jquery.com/jquery-1.10.2.js"></script>
	<style>
		#chartDiv {
		  width: 100%;
		  height: 500px;
		  font-size: 11px;
		}

		.amcharts-pie-slice {
		  transform: scale(1);
		  transform-origin: 50% 50%;
		  transition-duration: 0.3s;
		  transition: all .3s ease-out;
		  -webkit-transition: all .3s ease-out;
		  -moz-transition: all .3s ease-out;
		  -o-transition: all .3s ease-out;
		  cursor: pointer;
		  box-shadow: 0 0 30px 0 #000;
		}

		.amcharts-pie-slice:hover {
		  transform: scale(1.1);
		  filter: url(#shadow);
		}
	</style>	
  </head>
  <body>
    <div id="chartDiv"></div>
  </body>
	<script type="text/javascript">
		
		var urlMadrid = "http://api.wunderground.com/api/ff49550da16a71d5/geolookup/forecast/q/ES/Madrid.json";
		var url2 = "http://api.wunderground.com/api/ff49550da16a71d5/geolookup/forecast/q/FR/Paris.json";
		var url3 = "http://api.wunderground.com/api/ff49550da16a71d5/geolookup/forecast/q/UK/London.json";
		var url4 = "http://api.wunderground.com/api/ff49550da16a71d5/geolookup/forecast/q/IT/Rome.json";
		var url5 = "http://api.wunderground.com/api/ff49550da16a71d5/geolookup/forecast/q/DE/Berlim.json";
		var url6 = "http://api.wunderground.com/api/ff49550da16a71d5/geolookup/forecast/q/HOL/Amstardam.json";
		
		var Madridlat;
		var Madridlon;
		var Madridicon;
		
		var ajaxCalls = [];

	   ajaxCalls.push($.ajax({
		  dataType: "jsonp",
		  url: urlMadrid,
		}));
		
		ajaxCalls.push($.ajax({
		  dataType: "jsonp",
		  url: url2,
		}));

	var asd = []
		
	$.when.apply($, ajaxCalls).done(function() {

		// arguments here will be arrays for the ajax requests in
		// ajaxCalls, where each array looks like [ data , statusText, jqXHR ]
		var args = Array.prototype.slice.call(arguments, 0);

		for(var i = 0; i < args.length; i++){
		   storeDataInArray(args[i][0])
		}

		// do something with all results from storeDataInArray() function calls
	
		function storeDataInArray(data)
		{
			asd.push(data);
			alert(data.location.lat);
		}
		
		alert(asd.length);
	});
		
		
		var map = AmCharts.makeChart( "chartdiv", {

		  type: "map",
		  "theme": "light",

		  dataProvider: {
			map: "worldLow",
			zoomLevel: 5.5,
			zoomLongitude: 10,
			zoomLatitude: 52,
			images: [ {
			/*
			  latitude: data.location.lat,
			  longitude: data.location.lon,
			  imageURL: data.forecast.icon_url,
			  */
			   latitude: Madridlat,
			  longitude: Madridlon,
			  imageURL: Madridicon,
			  width: 32,
			  height: 32,
			  label: data.location.city + ' ' + data.forecast.txt_forecast.forecastday[0].fcttext_metric
			} ]
		  },

		  imagesSettings: {
			labelRollOverColor: "#000",
			labelPosition: "bottom"
		  },

		  areasSettings: {
			rollOverOutlineColor: "#FFFFFF",
			rollOverColor: "#CC0000",
			alpha: 0.8
		  },

		  "export": {
			"enabled": true
		  }
		} );
/*
		function success(data) {
			alert(data.forecast.txt_forecast.date + '\n' + data.forecast.txt_forecast.forecastday[0].fcttext );
		}
		
		
var map = AmCharts.makeChart( "chartdiv", {

  type: "map",
  "theme": "light",

  dataProvider: {
    map: "worldLow",
    zoomLevel: 5.5,
    zoomLongitude: 10,
    zoomLatitude: 52,
    images: [ {
      latitude: data.location.lat,
      longitude: data.location.lon,
      imageURL: data.forecast.icon_url,
      width: 32,
      height: 32,
      label: data.location.city + ' ' + data.forecast.txt_forecast.forecastday[0].fcttext_metric
    }, 

	
	
		{
      latitude: 48.856614,
      longitude: 2.352222,
      imageURL: "//www.amcharts.com/images/weather/weather-storm.png",
      width: 32,
      height: 32,
      label: "Paris: +18C"
    }, {
      latitude: 52.520007,
      longitude: 13.404954,
      imageURL: "//www.amcharts.com/images/weather/weather-clouds.png",
      width: 32,
      height: 32,
      label: "Berlin: +13C"
    }, {
      latitude: 52.229676,
      longitude: 21.012229,
      imageURL: "//www.amcharts.com/images/weather/weather-clear.png",
      width: 32,
      height: 32,
      label: "Warsaw: +22C"
    }, {
      latitude: 41.872389,
      longitude: 12.480180,
      imageURL: "//www.amcharts.com/images/weather/weather-clear.png",
      width: 32,
      height: 32,
      label: "Rome: +29C"
    }, {
      latitude: 51.507351,
      longitude: -0.127758,
      imageURL: "//www.amcharts.com/images/weather/weather-showers.png",
      width: 32,
      height: 32,
      label: "London: +10C"
    }, {
      latitude: 59.329323,
      longitude: 18.068581,
      imageURL: "//www.amcharts.com/images/weather/weather-rain.png",
      width: 32,
      height: 32,
      label: "Stockholm: +8C"
    } ]
  },

  imagesSettings: {
    labelRollOverColor: "#000",
    labelPosition: "bottom"
  },

  areasSettings: {
    rollOverOutlineColor: "#FFFFFF",
    rollOverColor: "#CC0000",
    alpha: 0.8
  },

  "export": {
    "enabled": true
  }
} );

		
		*/
		
	</script>
</html>
